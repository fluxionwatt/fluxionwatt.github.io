---
sidebar_position: 2
---

# MQTT网关设备接入

## 1、接入步骤

1. 创建设备模型(可选)
2. 创建MQTT网关设备模板
3. 创建MQTT网关子设备模板
4. 创建网关设备
5. 创建网关子设备
6. 在已创建的网关设备里，关联网关子设备并配置子设备地址
7. 根据网关设备里的**连接**页信息配置网关设备的凭证信息
8. 开启设备
9. 查看设备数据

> [网关设备MQTT数据交互规范](./mqtt-gateway-rule.md)

## 2、操作

### 2.1、创建设备模型（可选）

- 进入ThinsPanel系统，点击设备辑入-设备模型，创建设备模型，并针对遥测、属性、事件、命令等配置名称和标识符的映射关系。
![descript](./image/image19.png)

### 2.2、创建MQTT网关设备的设备模板

- 创建设备模板，选择刚才建立的设备模型，并设备模板中的协议、数据处理、自动化、告警等配置。如果设备发送的是二进制等非json格式数据时，需要在数据处理中配置数据预处理脚本。
![descript](./image/image20.png)

### 2.3、创建MQTT网关子设备模板

- 同创建网关的设备模板

### 2.4、创建设备并关联

- 在Thinspanel中创建网关设备和子网关设备，并设置设备的用户名和密码，选择设备的设备模板、自动化、告警等。
- 在已创建的网关设备里，关联网关子设备并配置子设备地址
![descript](./image/image21.png)

### 2.5、配置设备端

- 根据网关设备里的**连接**页信息配置网关设备的凭证信息，根据[网关设备MQTT数据交互规范](./mqtt-gateway-rule.md)配置主题等。
- 设备端根据协议配置凭证信息和上报规则，然后进行数据上报。

### 2.6、开启设备

- 开启设备

### 2.7、查看数据

- 通过设备-遥测查看设备数据，并可在平台上进行遥测数据下发，属性、命令下发等来控制设备。
![descript](./image/image22.png)

## 设备和平台数据交互规范

[网关设备MQTT数据交互规范](./mqtt-gateway-rule.md)
