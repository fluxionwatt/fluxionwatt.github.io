import{_ as e,c as i,o as a,ah as o,cf as c,cg as r}from"./chunks/framework.BDBjiFeZ.js";const f=JSON.parse('{"title":"TCP","description":"","frontmatter":{"sidebar_position":5},"headers":[],"relativePath":"en_US/device-connectivity/tcp.md","filePath":"en_US/device-connectivity/tcp.md"}'),l={name:"en_US/device-connectivity/tcp.md"};function s(n,t,p,d,h,P){return a(),i("div",null,[...t[0]||(t[0]=[o('<h1 id="tcp" tabindex="-1">TCP <a class="header-anchor" href="#tcp" aria-label="Permalink to “TCP”">​</a></h1><p>There are two ways for TCP device connectivity:</p><h2 id="_1-via-tcp-device-connectivity-service" tabindex="-1">1. Via TCP Device Connectivity Service <a class="header-anchor" href="#_1-via-tcp-device-connectivity-service" aria-label="Permalink to “1. Via TCP Device Connectivity Service”">​</a></h2><p><code>TCP Device Connectivity Service</code> runs separately. Devices interact with platform through it. It can run on the same machine or a different machine accessible via network.</p><h3 id="protocol-classification" tabindex="-1">Protocol Classification <a class="header-anchor" href="#protocol-classification" aria-label="Permalink to “Protocol Classification”">​</a></h3><p>Supports two types:</p><ol><li>Custom TCP Protocol</li><li>Official TCP Protocol</li></ol><p>:::note</p><p>Both types support <strong>Standard Device</strong> and <strong>Gateway Device</strong>.</p><p>:::</p><h3 id="custom-tcp-protocol" tabindex="-1">Custom TCP Protocol <a class="header-anchor" href="#custom-tcp-protocol" aria-label="Permalink to “Custom TCP Protocol”">​</a></h3><p>Pass-through mode.</p><h4 id="steps" tabindex="-1">Steps: <a class="header-anchor" href="#steps" aria-label="Permalink to “Steps:”">​</a></h4><ol><li><p>Create device, select <code>Custom TCP Protocol</code> in Edit Params, get AccessToken and address. <img src="'+c+'" alt="Edit Params"></p></li><li><p>In Device Config, set buffer size (Default 1KB). <img src="'+r+'" alt="Device Config"></p></li><li><p>Write Data Processing Script (Device List -&gt; Edit Params -&gt; Script).</p><ul><li>Uplink Script: Convert custom TCP msg to platform JSON. <ul><li>Device: <code>{&quot;temperature&quot;:36.5,&quot;humidity&quot;:52}</code></li><li>Gateway: <code>{&quot;3c20c6206&quot;:{&quot;temperature&quot;:36.5,&quot;humidity&quot;:52}}</code> (&quot;3c20c6206&quot; is sub-device addr).</li></ul></li><li>Downlink Script: Convert platform JSON to custom TCP msg.</li></ul></li><li><p>Establish connection, push AccessToken first for authentication.</p></li></ol><h3 id="official-tcp-protocol" tabindex="-1">Official TCP Protocol <a class="header-anchor" href="#official-tcp-protocol" aria-label="Permalink to “Official TCP Protocol”">​</a></h3><p>Defined spec by the service.</p><h4 id="spec" tabindex="-1">Spec <a class="header-anchor" href="#spec" aria-label="Permalink to “Spec”">​</a></h4><p>Connect and send structure:</p><table tabindex="0"><thead><tr><th>IDENT</th><th>IDENT</th><th>TYPE</th><th>CMD</th><th>LENGTH</th><th>PAYLOAD</th></tr></thead><tbody><tr><td>&#39;T&#39;</td><td>&#39;P&#39;</td><td>1 byte</td><td>1 byte</td><td>4 byte</td><td>Variable</td></tr></tbody></table><ul><li>TYPE:<br> 0x0: Data Packet<br> 0x1: Heartbeat</li><li>CMD:<br> 0x0: Auth<br> 0x1: Publish Attributes<br> 0x2: Push Events</li><li>LENGTH: Payload length</li><li>PAYLOAD: Data If CMD 0x0, Payload is AccessToken<br> If CMD 0x1, Payload is Attributes<br> If CMD 0x2, Payload is Events</li></ul><h4 id="steps-1" tabindex="-1">Steps <a class="header-anchor" href="#steps-1" aria-label="Permalink to “Steps”">​</a></h4><ol><li>Create device, select <code>Official TCP Protocol</code>, get AccessToken.</li><li>(Optional) Write script if Payload is not platform JSON.</li><li>Establish connection, send CMD 0x0 with AccessToken. Then send Attrs/Events.</li></ol><h3 id="tcp-service-github" tabindex="-1">TCP Service GitHub <a class="header-anchor" href="#tcp-service-github" aria-label="Permalink to “TCP Service GitHub”">​</a></h3><p><a href="https://github.com/ThingsPanel/tcp-protocol-plugin" target="_blank" rel="noreferrer">https://github.com/ThingsPanel/tcp-protocol-plugin</a></p>',24)])])}const b=e(l,[["render",s]]);export{f as __pageData,b as default};
