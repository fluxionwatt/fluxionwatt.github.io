import{_ as i,c as a,o as e,ah as l}from"./chunks/framework.BDBjiFeZ.js";const g=JSON.parse('{"title":"System Upgrade Guide","description":"","frontmatter":{"sidebar_position":8},"headers":[],"relativePath":"en_US/installation/system_upgrade.md","filePath":"en_US/installation/system_upgrade.md"}'),n={name:"en_US/installation/system_upgrade.md"};function t(p,s,h,r,k,d){return e(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="system-upgrade-guide" tabindex="-1">System Upgrade Guide <a class="header-anchor" href="#system-upgrade-guide" aria-label="Permalink to “System Upgrade Guide”">​</a></h1><h2 id="version-compatibility" tabindex="-1">Version Compatibility <a class="header-anchor" href="#version-compatibility" aria-label="Permalink to “Version Compatibility”">​</a></h2><p>:::caution Important Direct upgrade from ThingsPanel v0.5.4 to v1.0.0 is <strong>NOT</strong> supported. A fresh deployment is required. :::</p><h2 id="docker-deployment-upgrade-guide" tabindex="-1">Docker Deployment Upgrade Guide <a class="header-anchor" href="#docker-deployment-upgrade-guide" aria-label="Permalink to “Docker Deployment Upgrade Guide”">​</a></h2><h3 id="pre-upgrade-preparation" tabindex="-1">Pre-upgrade Preparation <a class="header-anchor" href="#pre-upgrade-preparation" aria-label="Permalink to “Pre-upgrade Preparation”">​</a></h3><ol><li><p><strong>Data Backup</strong></p><ul><li>Backup Database</li><li>Backup Configuration Files</li><li>Backup Custom Plugins and Extensions</li></ul></li><li><p><strong>Environment Check</strong></p><ul><li>Confirm sufficient system resources</li><li>Verify storage space</li><li>Check status of existing services</li></ul></li></ol><h3 id="upgrade-methods" tabindex="-1">Upgrade Methods <a class="header-anchor" href="#upgrade-methods" aria-label="Permalink to “Upgrade Methods”">​</a></h3><p>You can choose one of the following two upgrade methods:</p><ul><li><strong>Partial Container Upgrade</strong> (Update specific services only)</li><li><strong>Full System Upgrade</strong> (Update all components)</li></ul><h3 id="partial-container-upgrade-process" tabindex="-1">Partial Container Upgrade Process <a class="header-anchor" href="#partial-container-upgrade-process" aria-label="Permalink to “Partial Container Upgrade Process”">​</a></h3><h4 id="_1-container-and-volume-mapping" tabindex="-1">1. Container and Volume Mapping <a class="header-anchor" href="#_1-container-and-volume-mapping" aria-label="Permalink to “1. Container and Volume Mapping”">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Frontend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-vue:nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MQTT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-gmqtt:gmqtt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-go:go</span></span></code></pre></div><h4 id="_2-upgrade-steps" tabindex="-1">2. Upgrade Steps <a class="header-anchor" href="#_2-upgrade-steps" aria-label="Permalink to “2. Upgrade Steps”">​</a></h4><ol><li><p>Update Source Code</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span></span></code></pre></div></li><li><p>Stop and Clean Target Containers</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Stop container</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ContainerI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Remove container</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ContainerI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Remove image</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rmi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ImageI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></li><li><p>Clean Volumes</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Prune unused volumes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prune</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># List existing volumes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Remove specific volumes (if needed)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-docker_nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-docker_gmqtt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thingspanel-docker_go</span></span></code></pre></div></li><li><p>Redeploy Services</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span></span></code></pre></div></li></ol><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>If the new version uses the same image tag, ensure you delete the local image and pull again to get the latest build.</p></div><h3 id="full-system-upgrade-process" tabindex="-1">Full System Upgrade Process <a class="header-anchor" href="#full-system-upgrade-process" aria-label="Permalink to “Full System Upgrade Process”">​</a></h3><ol><li><p><strong>Preparation</strong></p><ul><li>Compare the new and old <code>docker-compose.yml</code> files to confirm services needing updates.</li><li>Update source code to the target version.</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span></span></code></pre></div></li><li><p><strong>Stop Existing Services</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span></code></pre></div></li><li><p><strong>Start New Version</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div></li></ol><h3 id="configuration-updates" tabindex="-1">Configuration Updates <a class="header-anchor" href="#configuration-updates" aria-label="Permalink to “Configuration Updates”">​</a></h3><p>To modify configurations in volumes:</p><ol><li><p>Find Volume Location</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># List all volumes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Inspect specific volume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inspect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">VolumeNam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></li><li><p>Modify Configuration</p><ul><li>Directly edit the config files in the volume directory.</li><li>Note: Applications generally prioritize configurations from Environment Variables.</li></ul></li></ol><div class="info custom-block"><p class="custom-block-title">Precautions</p><ol><li>Always backup important data before upgrading.</li><li>It is recommended to test the upgrade in a staging environment first.</li><li>Preserve custom configurations during the upgrade.</li><li>Rollback to the backup version if issues occur.</li></ol></div><h2 id="source-code-deployment-upgrade" tabindex="-1">Source Code Deployment Upgrade <a class="header-anchor" href="#source-code-deployment-upgrade" aria-label="Permalink to “Source Code Deployment Upgrade”">​</a></h2><p>For source code deployment environments:</p><ol><li><p>Update Source Code</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">target-versio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></li><li><p>Recompile</p></li><li><p>Restart Services</p></li></ol>`,24)])])}const c=i(n,[["render",t]]);export{g as __pageData,c as default};
