import{_ as i,c as t,o as a,ah as e,dw as n,dx as r,dy as d,dz as l,dA as p}from"./chunks/framework.BDBjiFeZ.js";const m=JSON.parse('{"title":"Firmware Upgrade (OTA)","description":"","frontmatter":{"sidebar_position":2},"headers":[],"relativePath":"en_US/user-guide/tenant-operation-manual/product-management/ota.md","filePath":"en_US/user-guide/tenant-operation-manual/product-management/ota.md"}'),h={name:"en_US/user-guide/tenant-operation-manual/product-management/ota.md"};function o(k,s,g,c,u,E){return a(),t("div",null,[...s[0]||(s[0]=[e('<h1 id="firmware-upgrade-ota" tabindex="-1">Firmware Upgrade (OTA) <a class="header-anchor" href="#firmware-upgrade-ota" aria-label="Permalink to “Firmware Upgrade (OTA)”">​</a></h1><p>OTA stands for &quot;Over-The-Air technology&quot;, which enables remote management of software through mobile communication interfaces. Simply put, it is remote firmware upgrading.</p><h2 id="function-description" tabindex="-1">Function Description <a class="header-anchor" href="#function-description" aria-label="Permalink to “Function Description”">​</a></h2><ul><li><strong>Upgrade Package Management</strong>: Add upgrade packages for different versions of different products.</li><li><strong>Task Management</strong>: Create upgrade tasks, set upgrade time (immediate or scheduled), select devices to upgrade (all or partial).</li><li><strong>Upgrade Report</strong>: View statistics of Pending, Pushed, Upgrading, Success, Failure, and Cancelled. View upgrade progress, and retry failed upgrades.</li></ul><h2 id="ota-upgrade-process" tabindex="-1">OTA Upgrade Process <a class="header-anchor" href="#ota-upgrade-process" aria-label="Permalink to “OTA Upgrade Process”">​</a></h2><p>The OTA upgrade process under MQTT protocol is shown below. <img src="'+n+`" alt="OTA Process"></p><h2 id="ota-upgrade-description" tabindex="-1">OTA Upgrade Description <a class="header-anchor" href="#ota-upgrade-description" aria-label="Permalink to “OTA Upgrade Description”">​</a></h2><ul><li>If the device needs to report the version number before the first upgrade, it is recommended to report it once during system startup, without periodic reporting. After a successful upgrade, report the version immediately.</li><li>After receiving the upgrade notification from the IoT platform, the device can download the upgrade package immediately or fetch upgrade info later when idle.</li><li>The IoT platform determines if the OTA upgrade is successful based on whether the progress reported by the device is 100%.</li><li>For upgrading devices, if the pushed version matches the current version, the platform defaults to pushing the latest version info 3 times. The 4th time counts as failure (retry allowed).</li><li>Supports breakpoint resume (see interface docs).</li></ul><h2 id="data-format-description" tabindex="-1">Data Format Description <a class="header-anchor" href="#data-format-description" aria-label="Permalink to “Data Format Description”">​</a></h2><p>Topics and data formats used in OTA:</p><ol><li><p>(Optional) Device connects to OTA service and reports version. Device pushes current OTA module version to Topic: <code>ota/device/inform</code>.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;147258369&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;params&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v1.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>Message ID. Length 10, unique in current device.</td></tr><tr><td>version</td><td>String</td><td>OTA module version.</td></tr><tr><td>module</td><td>String</td><td>OTA module name. &#39;default&#39; represents entire firmware.</td></tr></tbody></table></li><li><p>After triggering upgrade in console, device receives upgrade package URL. Device subscribes to Topic: <code>ota/device/inform/\\$\\{AccessToken\\}</code>.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;147258369&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;params&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v1.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;size&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">432945</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://dev.thingspane.cn/files/ota/s121jg3245gg.zip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;signMethod&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Md5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;sign&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a243fgh4b9v&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MCU&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;extData&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;key1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;key2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value2&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>Long</td><td>Message ID.</td></tr><tr><td>code</td><td>String</td><td>Status code.</td></tr><tr><td>version</td><td>String</td><td>Upgrade package version.</td></tr><tr><td>size</td><td>Long</td><td>File size (bytes).</td></tr><tr><td>url</td><td>String</td><td>Storage URL on OSS.</td></tr><tr><td>sign</td><td>String</td><td>File signature.</td></tr><tr><td>signMethod</td><td>String</td><td>Sign method (SHA256, MD5). Android diff supports MD5 only.</td></tr><tr><td>module</td><td>String</td><td>Module name. Default module implies no module param.</td></tr><tr><td>extData</td><td>Object</td><td>Custom info. _package_udi is reserved.</td></tr></tbody></table></li><li><p>During upgrade, device reports progress to Topic: <code>ota/device/progress</code>.</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;step&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;desc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Upgrade Progress 100%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MCU&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>step</td><td>String</td><td>Progress percentage (1-100). -1: Failed. -2: Download failed. -3: Check failed. -4: Write failed.</td></tr><tr><td>desc</td><td>String</td><td>Description (&lt;128 chars). Can carry error info on exception.</td></tr><tr><td>module</td><td>String</td><td>Module name. Optional.</td></tr></tbody></table></li></ol><h2 id="operation-steps" tabindex="-1">Operation Steps <a class="header-anchor" href="#operation-steps" aria-label="Permalink to “Operation Steps”">​</a></h2><ol><li><code>Product Management</code> -&gt; <code>Firmware Upgrade</code> -&gt; <code>Add Upgrade Package</code>. <img src="`+r+'" alt="Add Package"></li><li>Click <code>View</code> to enter Task List. <img src="'+d+'" alt="Task List"></li><li>Click <code>Add Upgrade Task</code>. <img src="'+l+'" alt="Add Task"></li><li>Click <code>View</code> to enter Upgrade Details. View progress, retry failures, or cancel. <img src="'+p+'" alt="Upgrade Details"></li></ol>',13)])])}const F=i(h,[["render",o]]);export{m as __pageData,F as default};
