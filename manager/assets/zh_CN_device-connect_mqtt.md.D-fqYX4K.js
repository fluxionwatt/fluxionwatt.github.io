import{_ as t,c as s,o as e,ah as i,eZ as n,e_ as l}from"./chunks/framework.BDBjiFeZ.js";const m=JSON.parse('{"title":"MQTT直连设备接入","description":"","frontmatter":{"sidebar_position":1},"headers":[],"relativePath":"zh_CN/device-connect/mqtt.md","filePath":"zh_CN/device-connect/mqtt.md"}'),o={name:"zh_CN/device-connect/mqtt.md"};function p(r,a,d,h,c,u){return e(),s("div",null,[...a[0]||(a[0]=[i('<h1 id="mqtt直连设备接入" tabindex="-1">MQTT直连设备接入 <a class="header-anchor" href="#mqtt直连设备接入" aria-label="Permalink to “MQTT直连设备接入”">​</a></h1><h2 id="接入步骤" tabindex="-1">接入步骤 <a class="header-anchor" href="#接入步骤" aria-label="Permalink to “接入步骤”">​</a></h2><ol><li>创建设备</li><li>选择设备模板（可不选择）</li><li>获得设备端配置参数</li><li>配置设备端</li><li>完成接入</li></ol><h2 id="快速接入视频" tabindex="-1">快速接入视频 <a class="header-anchor" href="#快速接入视频" aria-label="Permalink to “快速接入视频”">​</a></h2><h2 id="详细过程" tabindex="-1">详细过程 <a class="header-anchor" href="#详细过程" aria-label="Permalink to “详细过程”">​</a></h2><h3 id="创建设备" tabindex="-1">创建设备 <a class="header-anchor" href="#创建设备" aria-label="Permalink to “创建设备”">​</a></h3><p>在【设备接入】菜单中，点击【添加设备】，手动添加即可添加设备，添加时有2个选项。</p><ul><li>不选择【设备模板】：默认使用MQTT协议，采用MQTT Basic认证连接</li><li>选择【设备模板】：使用设备模板，则采用设备模板中绑定的协议</li></ul><h3 id="配置设备端" tabindex="-1">配置设备端 <a class="header-anchor" href="#配置设备端" aria-label="Permalink to “配置设备端”">​</a></h3><p><img src="'+n+`" alt="MQTT连接参数"></p><h3 id="模拟报送" tabindex="-1">模拟报送 <a class="header-anchor" href="#模拟报送" aria-label="Permalink to “模拟报送”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>mosquitto_pub -h 47.115.210.16 -p 1883 -t &quot;devices/telemetry&quot; -m &quot;{\\&quot;test_data1\\&quot;:25.5,\\&quot;test_data2\\&quot;:60}&quot; -u &quot;5547c615-593e-6fb1-41f&quot; -P &quot;ced8bfd&quot; -i &quot;mqtt_28e7fdfd-514&quot;</span></span></code></pre></div><p>这个命令使用 mosquitto_pub 工具向一个 MQTT 服务器发布消息。下面是对该命令各个部分的详细解释：</p><p>mosquitto_pub：这是 Mosquitto 提供的一个命令行工具，用于向 MQTT 服务器发布消息。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>-h 47.115.210.16：指定 MQTT 服务器的主机地址（IP 地址为 47.115.210.16）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-p 1883：指定 MQTT 服务器的端口号，这里是 1883，这是 MQTT 的默认端口。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-t &quot;devices/telemetry&quot;：指定消息发布的主题（topic），这里是 devices/telemetry。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-m &quot;{\\&quot;test_data1\\&quot;:25.5,\\&quot;test_data2\\&quot;:60}&quot;：指定消息的内容（payload），这里是一个 JSON 格式的字符串，包含两个数据字段 test_data1 和 test_data2，它们的值分别是 25.5 和 60。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-u &quot;5547c615-593e-6fb1-41f&quot;：指定用于连接 MQTT 服务器的用户名。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-P &quot;ced8bfd&quot;：指定用于连接 MQTT 服务器的密码。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-i &quot;mqtt_28e7fdfd-514&quot;：指定客户端 ID，这里是 mqtt_28e7fdfd-514。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>总结起来，这个命令通过 MQTT 协议向指定的服务器发布一条消息，主题是 devices/telemetry，消息内容是 {&quot;test_data1&quot;:25.5,&quot;test_data2&quot;:60}，使用了特定的用户名和密码进行身份验证，并指定了客户端 ID。</span></span></code></pre></div><h3 id="采用mosquitto-mqtt客户端报送" tabindex="-1">采用Mosquitto MQTT客户端报送 <a class="header-anchor" href="#采用mosquitto-mqtt客户端报送" aria-label="Permalink to “采用Mosquitto MQTT客户端报送”">​</a></h3><p>需要安装Mosquitto MQTT客户端到本地操作系统，命令同模拟发送命令。</p><h3 id="推送后结果" tabindex="-1">推送后结果 <a class="header-anchor" href="#推送后结果" aria-label="Permalink to “推送后结果”">​</a></h3><p><img src="`+l+'" alt="数据推送结果"></p><h2 id="mqtt接入规范" tabindex="-1">MQTT接入规范 <a class="header-anchor" href="#mqtt接入规范" aria-label="Permalink to “MQTT接入规范”">​</a></h2><p><a href="./mqtt-device-rule.html">直连设备MQTT数据交互规范</a></p><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to “常见问题”">​</a></h2><ol><li>注意MQTT Broker和平台可能不是一个地址。</li><li>MQTT ClientID需要唯一不重复。</li><li>如果设备在线但是没消息，可能是主题错误。</li><li>模拟推送正常意味着平台的组件工作正常，问题可能在设备端。</li></ol>',23)])])}const T=t(o,[["render",p]]);export{m as __pageData,T as default};
